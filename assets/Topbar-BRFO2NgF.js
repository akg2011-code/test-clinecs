import{c as be,j as e,a as D,Y as ye,r as x,g as ve,h as Ce,o as Se,n as ke,e as Pe,f as _e,Q as re,t as Ee,Z as Me,$ as K,v as _,B as E,T as b,w as t,J as Ae,P as T,a0 as Fe,S as Le,C as z,M as X,a1 as Ie,O as Oe,H as ze,E as Ne}from"./index-DLnjnVCu.js";import{a as Be,u as $e,b as De}from"./HasPermission-Efb43n4z.js";import{b as ee,A as se,I as R,c as We}from"./index-CrveBHTj.js";import{F as Re,a as Ue,b as ae,c as Te}from"./index-DizZbtXV.js";import{u as Ve,R as He}from"./index-BiYRox9o.js";import{u as V,g as ne,M as ie,b as le,a as ce,c as Ye,h as qe,d as de,F as M,L as Ge,e as Qe,f as $,i as Ze,S as Je}from"./index.esm-CU9MGMRa.js";import{B as oe,a as Ke,b as Xe}from"./index-DoPvV33R.js";import{u as es,a as ss}from"./SettingData-5sbMzAiY.js";import{M as me,a as ue,b as he,c as N}from"./chunk-Z3VR2BFQ-Dh96I6nM.js";import{D as xe}from"./index-Q7d3q0Zt.js";import{u as pe}from"./useMutation-CH8xzEHB.js";import{F as as}from"./ForgetPassword-BJ8ivrvL.js";import{I as L}from"./chunk-FKYN3ZGE-BIoTHd0a.js";import{I as te,a as B}from"./chunk-2ZHRCML3-ZsOSKDi_.js";import{b as A,F,I as S}from"./utils-DHjTyQ2S.js";import{i as W}from"./image-BEsbZakN.js";import{V as os}from"./chunk-NTCQBYKE-B0koUvDf.js";var[ts,rs]=be({name:"AvatarStylesContext",hookName:"useAvatarStyles",providerName:"<Avatar/>"});function ns(o){var s;const a=o.split(" "),n=(s=a[0])!=null?s:"",c=a.length>1?a[a.length-1]:"";return n&&c?`${n.charAt(0)}${c.charAt(0)}`:n.charAt(0)}function fe(o){const{name:s,getInitials:a,...n}=o,c=rs();return e.jsx(D.div,{role:"img","aria-label":s,...n,__css:c.label,children:s?a==null?void 0:a(s):null})}fe.displayName="AvatarName";var je=o=>e.jsxs(D.svg,{viewBox:"0 0 128 128",color:"#fff",width:"100%",height:"100%",className:"chakra-avatar__svg",...o,children:[e.jsx("path",{fill:"currentColor",d:"M103,102.1388 C93.094,111.92 79.3504,118 64.1638,118 C48.8056,118 34.9294,111.768 25,101.7892 L25,95.2 C25,86.8096 31.981,80 40.6,80 L87.4,80 C96.019,80 103,86.8096 103,95.2 L103,102.1388 Z"}),e.jsx("path",{fill:"currentColor",d:"M63.9961647,24 C51.2938136,24 41,34.2938136 41,46.9961647 C41,59.7061864 51.2938136,70 63.9961647,70 C76.6985159,70 87,59.7061864 87,46.9961647 C87,34.2938136 76.6985159,24 63.9961647,24"})]});function ge(o){const{src:s,srcSet:a,onError:n,onLoad:c,getInitials:m,name:d,borderRadius:f,loading:u,iconLabel:l,icon:p=e.jsx(je,{}),ignoreFallback:r,referrerPolicy:j,crossOrigin:h}=o,g=ye({src:s,onError:n,crossOrigin:h,ignoreFallback:r})==="loaded";return!s||!g?d?e.jsx(fe,{className:"chakra-avatar__initials",getInitials:m,name:d}):x.cloneElement(p,{role:"img","aria-label":l}):e.jsx(D.img,{src:s,srcSet:a,alt:d,onLoad:c,referrerPolicy:j,crossOrigin:h??void 0,className:"chakra-avatar__img",loading:u,__css:{width:"100%",height:"100%",objectFit:"cover",borderRadius:f}})}ge.displayName="AvatarImage";var is={display:"inline-flex",alignItems:"center",justifyContent:"center",textAlign:"center",textTransform:"uppercase",fontWeight:"medium",position:"relative",flexShrink:0},U=ve((o,s)=>{const a=Ce("Avatar",o),[n,c]=x.useState(!1),{src:m,srcSet:d,name:f,showBorder:u,borderRadius:l="full",onError:p,onLoad:r,getInitials:j=ns,icon:h=e.jsx(je,{}),iconLabel:y=" avatar",loading:g,children:k,borderColor:v,ignoreFallback:C,crossOrigin:i,referrerPolicy:w,...O}=Se(o),I={borderRadius:l,borderWidth:u?"2px":void 0,...is,...a.container};return v&&(I.borderColor=v),e.jsx(D.span,{ref:s,...O,className:ke("chakra-avatar",o.className),"data-loaded":Pe(n),__css:I,children:e.jsxs(ts,{value:a,children:[e.jsx(ge,{src:m,srcSet:d,loading:g,onLoad:_e(r,()=>{c(!0)}),onError:p,getInitials:j,name:f,borderRadius:l,icon:h,iconLabel:y,ignoreFallback:C,crossOrigin:i,referrerPolicy:w}),k]})})});U.displayName="Avatar";const ls=async()=>{let o=t.role.name==="Doctor"?`get_doctor_notification/doctor/${t.id}`:"get_doctor_notification";return(await Ae(t.token,o)).data};function cs(){const[o,s]=x.useState(!1),[a,n]=x.useState(!1),c=V(),m=re(),d="/admin/",f=new Audio(`${d}/notification.mp3`),u=Ee();x.useEffect(()=>{const r=Me(K,j=>{f.play().catch(g=>console.error("Error playing sound:",g)),s(!0),u.invalidateQueries(["doctor-notification"]);const{title:h,body:y}=j.notification;return c({title:h,description:y,status:"info",duration:5e3,isClosable:!0,position:"top"})});return()=>r()},[K]);const{data:l,isLoading:p}=es({queryFn:ls,queryKey:["doctor-notification"]});return e.jsxs(me,{isOpen:a,onClose:()=>n(!1),children:[e.jsxs(ue,{as:_,variant:"ghost",colorScheme:"black",pos:"relative",onClick:()=>{s(!1),n(!0)},children:[e.jsx(Be,{fontSize:"18px"}),o&&e.jsx(E,{bg:"blue.500",borderRadius:"full",position:"absolute",top:"2",right:"3",w:2,h:2})]}),e.jsxs(he,{minW:"600px",maxH:"60vh",overflow:"hide",overflowY:"scroll",pt:0,children:[e.jsx(b,{p:2,fontSize:18,fontWeight:600,textAlign:"center",children:"Notifications"}),e.jsx(xe,{}),p?e.jsx(b,{p:4,children:"Loading"}):l==null?void 0:l.slice(0,20).map(r=>e.jsxs(E,{p:4,m:2,borderWidth:"1px",borderRadius:"lg",boxShadow:"sm",_hover:{boxShadow:"md"},maxW:"600px",cursor:"pointer",onClick:()=>{n(!1),r.file_id?m(`appointment/${r.appointment_id}`):r.prescription_id?m(`appointment/${r.appointment_id}`):r.appointment_id?m(`appointment/${r.appointment_id}`):m(`appointment/${r.appointment_id}`)},children:[e.jsx(b,{fontSize:"md",fontWeight:"bold",children:r.title}),e.jsx(b,{fontSize:"sm",color:"gray.500",children:r.body})]},r.id)),(l==null?void 0:l.length)===0&&e.jsx(E,{p:4,m:2,borderWidth:"1px",borderRadius:"lg",boxShadow:"sm",children:e.jsx(b,{children:"No notifications"})})]})]})}const ds=async o=>{let s={email:t.email,password:o};return(await T(t.token,"login",s)).status},ms=async o=>{let s={user_id:t.id,password:o};const a=await T(t.token,"update_password",s);if(a.response!==200)throw new Error(a.message);return a};function us({isOpen:o,onClose:s}){const[a,n]=x.useState(!1),[c,m]=x.useState(!1),[d,f]=x.useState(""),[u,l]=x.useState(""),[p,r]=x.useState(""),j=V(),{isOpen:h,onOpen:y,onClose:g}=ne(),k=i=>{i(w=>!w)},v=()=>d?u?p?p!==u?"Password Does not match!":null:"Confirm Password":"New Password":"Old Password",C=pe({mutationFn:async()=>{const i=v();if(i)throw new Error(`Please Enter ${i}`);const w=await ds(d);if(w===!1||!w||w!==!0)throw new Error("Incorrect Old password");await ms(u)},onError:i=>{$(j,"error",i.message)},onSuccess:()=>{l(),f(),r(),$(j,"success","Success"),s()}});return e.jsxs(e.Fragment,{children:[" ",e.jsxs(ie,{isOpen:o,onClose:s,isCentered:!0,children:[e.jsx(le,{}),e.jsxs(ce,{children:[e.jsx(Ye,{children:"Update Password"}),e.jsx(qe,{}),e.jsxs(de,{children:[e.jsxs(A,{mb:4,children:[e.jsxs(F,{alignItems:"start",justifyContent:"space-between",children:[" ",e.jsx(M,{children:"Old Password"}),e.jsx(Ge,{fontSize:12,color:"blue.500",onClick:y,textDecor:"underline",children:"Forget password?"})]}),e.jsxs(L,{children:[e.jsx(S,{type:a?"text":"password",placeholder:"Enter Old password",value:d,onChange:i=>f(i.target.value)}),e.jsx(te,{width:"4.5rem",children:e.jsx(_,{h:"1.75rem",size:"sm",onClick:()=>k(n),children:a?e.jsx(ee,{}):e.jsx(se,{})})})]})]}),e.jsxs(A,{mb:4,children:[e.jsx(M,{children:"New Password"}),e.jsxs(L,{children:[e.jsx(S,{type:c?"text":"password",placeholder:"Enter new password",value:u,onChange:i=>l(i.target.value)}),e.jsx(te,{width:"4.5rem",children:e.jsx(_,{h:"1.75rem",size:"sm",onClick:()=>k(m),children:c?e.jsx(ee,{}):e.jsx(se,{})})})]})]}),e.jsxs(A,{mb:4,children:[e.jsx(M,{children:"Confirm New Password"}),e.jsx(S,{type:"text",placeholder:"Confirm new password",value:p,onChange:i=>r(i.target.value)})]})]}),e.jsxs(Qe,{children:[e.jsx(_,{variant:"ghost",onClick:s,children:"Close"}),e.jsx(_,{colorScheme:"blue",mr:3,onClick:C.mutate,isLoading:C.isPending,children:"Update Password"})]})]})]}),e.jsx(as,{isOpen:h,onClose:g})]})}const hs=async o=>{const s=await T(t.token,"update_user",o);if(s.response!==200)throw new Error(s.message);return s};function Ls(){var O,I,H,Y,q,G,Q,Z,J;const[o,s]=x.useState(!1),{colorMode:a,toggleColorMode:n}=Fe(),m=Le().pathname.split("/")[1],{register:d,handleSubmit:f}=Ze(),[u]=Ve("(max-width: 600px)"),{isOpen:l,onOpen:p,onClose:r}=ne(),j=re(),{settingsData:h}=ss(),{hasPermission:y}=$e(),g=V(),k=()=>s(!0),v=()=>s(!1);x.useEffect(()=>{a==="dark"?document.body.classList.add("dark"):document.body.classList.remove("dark")},[a]);const C=h==null?void 0:h.find(P=>P.id_name==="logo"),i=pe({mutationFn:async P=>{await hs(P)},onError:P=>{$(g,"error",P.message)},onSuccess:()=>{$(g,"success","updated!"),v()}}),w=P=>{const we={...P,id:t.id};i.mutate(we)};return e.jsxs(F,{as:"header",align:"center",justify:"space-between",px:"4",py:"2",bg:z("white","gray.800"),boxShadow:"none",zIndex:"sticky",top:"0",position:"sticky",borderBottom:"1px solid",borderColor:z("gray.200","gray.600"),children:[e.jsxs(E,{display:"flex",alignItems:"center",gap:5,children:[" ",e.jsx(X,{w:12,src:`${W}/${C==null?void 0:C.value}`,fallbackSrc:"/logo.png"}),e.jsx(b,{fontSize:"xl",fontWeight:"500",mb:0,textTransform:"capitalize",children:m||"Dashboard"})]}),e.jsxs(F,{children:[e.jsx(cs,{}),e.jsx(R,{"aria-label":"Toggle color mode",icon:a==="light"?e.jsx(Re,{}):e.jsx(Ue,{}),onClick:()=>{n(),a==="light"?document.body.classList.add("dark"):document.body.classList.remove("dark")},variant:"ghost",colorScheme:"black"})," ",e.jsxs(me,{children:[e.jsx(ue,{as:R,variant:"ghost",colorScheme:"black",icon:e.jsx(ae,{})}),e.jsxs(he,{children:[e.jsxs(E,{p:2,w:300,children:[e.jsx(F,{justify:"center",children:e.jsx(U,{src:`${W}/${t.image}`,fallbackSrc:"/admin/profile.png",w:16})}),e.jsxs(b,{textAlign:"center",mt:2,fontSize:"lg",children:[t.f_name," ",t.l_name]}),e.jsx(b,{textAlign:"center",fontSize:"md",fontWeight:600,children:t.role.name})]}),e.jsx(xe,{mb:3}),e.jsx(N,{onClick:k,icon:e.jsx(ae,{}),children:"Account"}),e.jsx(N,{onClick:p,icon:e.jsx(He,{}),children:"Change Password"}),y("SETTING_VIEW")&&e.jsx(N,{onClick:()=>{j("/settings")},icon:e.jsx(We,{}),children:"Settings"}),e.jsx(N,{icon:e.jsx(Te,{}),onClick:()=>{Ie()},children:"Logout"})]})]})]}),e.jsxs(ie,{isOpen:o,onClose:v,isCentered:!0,scrollBehavior:u?"outside":"inside",size:"xl",children:[e.jsx(le,{}),e.jsxs(ce,{p:0,m:2,bg:"transparent",children:[" ",e.jsxs(de,{p:0,sx:{"&::-webkit-scrollbar":{display:"none"},scrollbarWidth:"none",msOverflowStyle:"none"},as:"form",onSubmit:f(w),children:[" ",e.jsx(Oe,{py:0,width:"100%",minHeight:!u&&"80vh",children:e.jsxs(E,{maxW:"100%",w:"full",bg:z("white","gray.800"),boxShadow:"2xl",rounded:"md",overflow:"hidden",children:[e.jsx(X,{h:"120px",w:"full",src:"https://images.unsplash.com/photo-1612865547334-09cb8cb455da?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=634&q=80",objectFit:"cover",alt:"#"}),e.jsxs(F,{justify:"center",mt:-12,pos:"relative",children:[e.jsx(U,{size:"xl",name:`${(O=t)==null?void 0:O.f_name} ${(I=t)==null?void 0:I.l_name}`,src:`${W}/${t.image}`,fallbackSrc:"/vite.svg"}),e.jsx(xs,{})]}),e.jsxs(E,{p:6,children:[e.jsxs(Je,{spacing:0,align:"center",mb:5,children:[e.jsxs(ze,{fontSize:"lg",fontWeight:500,fontFamily:"body",children:[(H=t)==null?void 0:H.f_name," ",(Y=t)==null?void 0:Y.l_name]}),e.jsxs(b,{color:"gray.500",fontSize:"xs",children:["Member Since"," ",Ne((q=t)==null?void 0:q.created_at).format("MMM DD YYYY")]})]}),e.jsxs(os,{direction:"row",justify:"center",spacing:6,children:[e.jsxs(F,{gap:4,children:[" ",e.jsxs(A,{id:"name",children:[e.jsx(M,{children:"First Name"}),e.jsxs(L,{borderColor:"#E0E1E7",children:[e.jsx(B,{pointerEvents:"none",children:e.jsx(oe,{color:"gray.800"})}),e.jsx(S,{type:"text",size:"md",defaultValue:(G=t)==null?void 0:G.f_name,...d("f_name",{required:!0})})]})]})," ",e.jsxs(A,{id:"name",children:[e.jsx(M,{children:"Name"}),e.jsxs(L,{borderColor:"#E0E1E7",children:[e.jsx(B,{pointerEvents:"none",children:e.jsx(oe,{color:"gray.800"})}),e.jsx(S,{type:"text",size:"md",defaultValue:(Q=t)==null?void 0:Q.l_name,...d("l_name",{required:!0})})]})]})]}),e.jsxs(A,{id:"email",children:[e.jsx(M,{children:"Email"}),e.jsxs(L,{borderColor:"#E0E1E7",children:[e.jsx(B,{pointerEvents:"none",children:e.jsx(Ke,{color:"gray.800"})}),e.jsx(S,{type:"email",size:"md",defaultValue:(Z=t)==null?void 0:Z.email,...d("email",{required:!1,pattern:"^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+.[a-zA-Z]{2,}$"})})]})]}),e.jsxs(A,{id:"Phone",children:[e.jsx(M,{children:"Phone"}),e.jsxs(L,{borderColor:"#E0E1E7",children:[e.jsx(B,{pointerEvents:"none",children:e.jsx(Xe,{color:"gray.800"})}),e.jsx(S,{isDisabled:!0,type:"tel",size:"md",value:(J=t)==null?void 0:J.phone})]})]})]}),e.jsx(_,{size:"sm",w:"full",mt:8,colorScheme:"blue",color:"white",rounded:"md",_hover:{transform:"translateY(-2px)",boxShadow:"lg"},type:"submit",isLoading:i.isPending,children:"Update"}),e.jsx(_,{mt:2,size:"sm",w:"full",bg:z("gray.600","gray.600"),color:"white",rounded:"md",_hover:{transform:"translateY(-2px)",boxShadow:"lg"},onClick:v,children:"Close"})]})]})})]})]})]}),e.jsx(us,{isOpen:l,onClose:r})]})}const xs=()=>{const o=x.useRef(null),s=()=>{o.current.click()},a=n=>{n.target.files[0]};return e.jsxs(e.Fragment,{children:[e.jsx(R,{icon:e.jsx(De,{fontSize:16}),colorScheme:"blue",onClick:s,size:"sm"}),e.jsx(S,{type:"file",ref:o,display:"none",onChange:a})]})};export{Ls as default};
