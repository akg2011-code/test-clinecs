import{J as P,w as R,r as c,Q as z,j as e,B as u,v as U,E as D,F as b}from"./index-DLnjnVCu.js";import{F as L}from"./index-DscDBtoO.js";import{e as Q}from"./index-DizZbtXV.js";import{u as k}from"./SettingData-5sbMzAiY.js";import{u as q,N as G,S as r,D as N,P as W}from"./Dashboard-BVf00d6b.js";import{u as I}from"./HasPermission-Efb43n4z.js";import{u as K}from"./index.esm-CU9MGMRa.js";import{F as m,I as O}from"./utils-DHjTyQ2S.js";import{R as V,a as y}from"./chunk-RDF2AYID-IaF24SSr.js";import{I as _}from"./index-CrveBHTj.js";import"./chunk-MGVPL3OH-BhiF1P3g.js";import"./image-BEsbZakN.js";import"./index-Q7d3q0Zt.js";import"./chunk-Z6RXEUPO-CjATnNZs.js";const H=async()=>(await P(R.token,"get_roles")).data,J=()=>{const{isLoading:s,data:t,error:a}=k({queryKey:["Roles"],queryFn:H});return{rolesData:t,rolesLoading:s,rolesError:a}},v=50,X=(s,t)=>{const a=(s-1)*t,n=a+t-1;return{startIndex:a,endIndex:n}},Z=s=>s==null?void 0:s.map(t=>{const{id:a,f_name:n,l_name:i,phone:l,gender:j,dob:h,email:p,image:x,wallet_amount:g,created_at:f}=t;return{id:a,image:x,name:`${n} ${i}`,Phone:`${l}`,Gender:j,DateOfBirth:D(h).format("DD MMM YYYY"),Email:p,"Wallet Balance":g,CreatedAt:D(f).format("DD MMM YYYY hh:mm a")}});function je(){const[s,t]=c.useState(),a=z(),{hasPermission:n}=I(),i=K(),[l,j]=c.useState(1),[h,p]=c.useState(""),x=q(h,1e3),{startIndex:g,endIndex:f}=X(l,v),E=c.useRef(null),{rolesData:A,rolesLoading:C}=J(),[w,Y]=c.useState(""),F=async()=>{const o=await P(R.token,`get_users/page?start=${g}&end=${f}&search=${x}&role_id=${w}`);return{data:o.data,total_record:o.total_record}},{isLoading:M,data:d,error:S}=k({queryKey:["users",l,x,w],queryFn:F}),$=o=>{j(o)},B=Math.ceil((d==null?void 0:d.total_record)/v),T=o=>(t(o),s);return c.useEffect(()=>{E.current&&E.current.scrollIntoView({behavior:"smooth",block:"start"})},[l]),c.useEffect(()=>{S&&!i.isActive("Errortoast")&&i({id:"Errortoast",title:"Oops!",description:"Something bad happened.",status:"error",duration:2e3,isClosable:!0,position:"top"})},[S,i]),n("USER_VIEW")?e.jsxs(u,{children:[M||!d||C?e.jsxs(u,{children:[e.jsxs(m,{mb:5,justify:"space-between",children:[e.jsx(r,{w:400,h:8}),e.jsx(r,{w:200,h:8})]}),e.jsx(r,{h:10,w:"100%",mt:2}),e.jsx(r,{h:10,w:"100%",mt:2}),e.jsx(r,{h:10,w:"100%",mt:2}),e.jsx(r,{h:10,w:"100%",mt:2}),e.jsx(r,{h:10,w:"100%",mt:2}),e.jsx(r,{h:10,w:"100%",mt:2}),e.jsx(r,{h:10,w:"100%",mt:2}),e.jsx(r,{h:10,w:"100%",mt:2}),e.jsx(r,{h:10,w:"100%",mt:2}),e.jsx(r,{h:10,w:"100%",mt:2})]}):e.jsxs(u,{children:[e.jsxs(m,{mb:5,justify:"space-between",align:"center",children:[e.jsx(O,{size:"md",placeholder:"Search",w:400,maxW:"50vw",onChange:o=>p(o.target.value),value:h}),e.jsx(u,{children:e.jsx(U,{isDisabled:!n("USER_ADD"),size:"sm",colorScheme:"blue",onClick:()=>{a("/users/add")},children:"Add New"})})]}),e.jsx(u,{my:2,children:e.jsx(V,{onChange:Y,value:w,children:e.jsxs(m,{direction:"row",gap:4,wrap:"wrap",children:[e.jsx(y,{value:"",children:"All"}),A.map(o=>e.jsx(y,{value:o.id.toString(),children:o.name},o.id))]})})}),e.jsx(N,{minPad:"1px 20px",data:Z(d.data),onActionClick:e.jsx(ee,{onClick:T,navigate:a})})]}),e.jsx(m,{justify:"center",mt:4,children:e.jsx(W,{currentPage:l,onPageChange:$,totalPages:B})})]}):e.jsx(G,{})}const ee=({onClick:s,rowData:t,DeleteonOpen:a,navigate:n})=>{const{hasPermission:i}=I();return e.jsxs(m,{justify:"center",children:[e.jsx(_,{isDisabled:!i("USER_UPDATE"),size:"sm",variant:"ghost",_hover:{background:"none"},onClick:()=>{s(t),n(`/user/update/${t.id}`)},icon:e.jsx(Q,{fontSize:18,color:b.colors.blue[500]})}),e.jsx(_,{isDisabled:!i("USER_DELETE"),size:"sm",variant:"ghost",_hover:{background:"none"},onClick:()=>{s(t),a()},icon:e.jsx(L,{fontSize:18,color:b.colors.red[500]})})]})};export{je as default};
