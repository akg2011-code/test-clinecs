import{r as y,t as A,j as e,v as k,D as $,w as C,Q as Y,B as g,F as O,av as E,J as G}from"./index-DLnjnVCu.js";import{F as V}from"./index-DscDBtoO.js";import{e as K}from"./index-DizZbtXV.js";import{u as X}from"./SettingData-5sbMzAiY.js";import{u as z}from"./useMutation-CH8xzEHB.js";import{A as Z,a as ee,N as se,S as c,D as te}from"./Dashboard-BVf00d6b.js";import{u as v,b as oe,c as re,d as ie,e as ne,f as u,g as ae}from"./index.esm-CU9MGMRa.js";import{u as w}from"./HasPermission-Efb43n4z.js";import{g as ce}from"./configs-3rp9fq6u.js";import{F as S,I as le,b as F}from"./utils-DHjTyQ2S.js";import{I as T}from"./index-CrveBHTj.js";import{S as I}from"./chunk-VTV6N5LE-DNMtDClH.js";import"./chunk-MGVPL3OH-BhiF1P3g.js";import"./image-BEsbZakN.js";import"./index-Q7d3q0Zt.js";import"./chunk-Z6RXEUPO-CjATnNZs.js";function de({isOpen:l,onClose:n,data:t}){const r=v(),i=y.useRef(),h=A(),[p,s]=y.useState(),a=async()=>{let m={id:t.id};try{s(!0);const o=await $(C.token,"delete_specialization",m);s(!1),o.response===200?(u(r,"success","Doctor Deleted!"),h.invalidateQueries("doctors"),n()):u(r,"error",o.message)}catch(o){s(!1),u(r,"error",JSON.stringify(o))}};return e.jsx(Z,{isOpen:l,onClose:n,leastDestructiveRef:i,isCentered:!0,children:e.jsx(oe,{children:e.jsxs(ee,{children:[e.jsxs(re,{fontSize:"lg",fontWeight:"semi-bold",children:["Delete Doctor ("," ",e.jsxs("b",{children:[t==null?void 0:t.id," , ",t==null?void 0:t.f_name," ",t==null?void 0:t.l_name]})," ",")"]}),e.jsx(ie,{children:"Are you sure? You can not undo this action afterwards."}),e.jsxs(ne,{children:[e.jsx(k,{ref:i,onClick:n,colorScheme:"gray",size:"sm",children:"Cancel"}),e.jsx(k,{colorScheme:"red",onClick:a,ml:3,size:"sm",isLoading:p,children:"Delete Doctor"})]})]})})})}function Te(){const{hasPermission:l}=w(),[n,t]=y.useState(),[r,i]=y.useState(),{isOpen:h,onClose:p}=ae(),s=Y(),a=v(),m="Errortoast",o=async()=>{await ce();const d=await G(C.token,"get_doctor");return d==null?void 0:d.data.map(x=>{const{id:j,user_id:f,image:D,f_name:B,l_name:N,phone:L,email:q,specialization:M,department_name:J,active:H,stop_booking:W}=x;return{id:j,UserID:f,image:D,Name:`${B} ${N}`,phone:L,email:q,specialization:M,dept:J,active:e.jsx(me,{id:f,isActive:H}),"Stop Booking":e.jsx(he,{id:f,isStop_booking:W})}})},P=d=>{t(d)},{isLoading:Q,data:_,error:R}=X({queryKey:["doctors"],queryFn:o});R&&(a.isActive(m)||a({id:m,title:"oops!.",description:"Something bad happens.",status:"error",duration:2e3,isClosable:!0,position:"top"}));function U(d,b=""){return b?d.filter(x=>{var j;for(const f in x){const D=(j=x[f])==null?void 0:j.toString().toLowerCase();if(D&&D.includes(b.toLowerCase()))return!0}return!1}):d}return l("DOCTOR_VIEW")?e.jsxs(g,{children:[Q||!_?e.jsxs(g,{children:[e.jsxs(S,{mb:5,justify:"space-between",children:[e.jsx(c,{w:400,h:8}),e.jsx(c,{w:200,h:8})]}),e.jsx(c,{h:10,w:"100%",mt:2}),e.jsx(c,{h:10,w:"100%",mt:2}),e.jsx(c,{h:10,w:"100%",mt:2}),e.jsx(c,{h:10,w:"100%",mt:2}),e.jsx(c,{h:10,w:"100%",mt:2}),e.jsx(c,{h:10,w:"100%",mt:2}),e.jsx(c,{h:10,w:"100%",mt:2}),e.jsx(c,{h:10,w:"100%",mt:2}),e.jsx(c,{h:10,w:"100%",mt:2}),e.jsx(c,{h:10,w:"100%",mt:2})]}):e.jsxs(g,{children:[e.jsxs(S,{mb:5,justify:"space-between",align:"center",children:[e.jsx(le,{size:"md",placeholder:"Search",w:400,maxW:"50vw",onChange:d=>{i(d.target.value)}}),e.jsx(g,{children:e.jsx(k,{isDisabled:!l("DOCTOR_ADD"),size:"sm",colorScheme:"blue",onClick:()=>{s("/doctors/add")},children:"Add New"})})]}),e.jsx(te,{data:U(_,r),onActionClick:e.jsx(ue,{onClick:P,navigate:s})})]}),e.jsx(de,{isOpen:h,onClose:p,data:n})]}):e.jsx(se,{})}const ue=({onClick:l,rowData:n,DeleteonOpen:t,navigate:r})=>{const{hasPermission:i}=w();return e.jsxs(S,{justify:"center",children:[e.jsx(T,{isDisabled:!i("DOCTOR_UPDATE"),size:"sm",variant:"ghost",_hover:{background:"none"},onClick:()=>{l(n),r(`/doctor/update/${n.UserID}`)},icon:e.jsx(K,{fontSize:18,color:O.colors.blue[500]})}),e.jsx(T,{isDisabled:!i("DOCTOR_UPDATE"),size:"sm",variant:"ghost",_hover:{background:"none"},onClick:()=>{l(n),t()},icon:e.jsx(V,{fontSize:18,color:O.colors.red[500]})})]})},me=({id:l,isActive:n})=>{const{hasPermission:t}=w(),r=v(),i=A(),h=async(s,a)=>{let m={id:s,active:a};try{const o=await E(C.token,"update_doctor",m);o.response===200?(u(r,"success","Doctor Updated!"),i.invalidateQueries("doctors"),i.invalidateQueries(["doctors","dashboard"]),i.invalidateQueries(["doctor",s])):u(r,"error",o.message)}catch(o){u(r,"error",JSON.stringify(o))}},p=z({mutationFn:async s=>{await h(s.id,s.active)}});return e.jsx(F,{display:"flex",alignItems:"center",children:e.jsx(I,{isDisabled:!t("DOCTOR_UPDATE"),defaultChecked:n===1,size:"sm",onChange:s=>{let a=s.target.checked?1:0;p.mutate({id:l,active:a})}})})},he=({id:l,isStop_booking:n})=>{const{hasPermission:t}=w(),r=v(),i=A(),h=async(s,a)=>{let m={id:s,stop_booking:a};try{const o=await E(C.token,"update_doctor",m);o.response===200?(u(r,"success","Doctor Updated!"),i.invalidateQueries("doctors"),i.invalidateQueries(["doctors","dashboard"]),i.invalidateQueries(["doctor",s])):u(r,"error",o.message)}catch(o){u(r,"error",JSON.stringify(o))}},p=z({mutationFn:async s=>{await h(s.id,s.stop_booking)}});return e.jsx(F,{display:"flex",alignItems:"center",children:e.jsx(I,{isDisabled:!t("DOCTOR_UPDATE"),defaultChecked:n===1,size:"sm",onChange:s=>{let a=s.target.checked?1:0;p.mutate({id:l,stop_booking:a})}})})};export{me as IsActive,he as StopBooking,Te as default};
