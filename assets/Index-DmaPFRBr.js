import{r as c,Q as R,j as e,B as E,v as $,F as I,E as P,J as Q,w as q}from"./index-DLnjnVCu.js";import{e as G}from"./index-DizZbtXV.js";import{u as V}from"./SettingData-5sbMzAiY.js";import{u as W,N as H,D as J,P as K,S as b}from"./Dashboard-BVf00d6b.js";import{u as S}from"./HasPermission-Efb43n4z.js";import{F as U}from"./index-DscDBtoO.js";import{A as X,D as Z,E as ee}from"./Add-C3HbTA4S.js";import{g as D,u as se}from"./index.esm-CU9MGMRa.js";import{F as d,I as te}from"./utils-DHjTyQ2S.js";import{I as F}from"./index-CrveBHTj.js";import"./chunk-MGVPL3OH-BhiF1P3g.js";import"./image-BEsbZakN.js";import"./index-Q7d3q0Zt.js";import"./chunk-Z6RXEUPO-CjATnNZs.js";import"./today-D_vLUvRX.js";import"./chunk-3RSXBRAN-DjkGz0-1.js";import"./UsersComboBox-DGcvoZQW.js";import"./popover-Bdb83bZr.js";import"./Users-BWgt3Tnp.js";import"./IsdModal-DvHKxEmI.js";import"./chunk-FKYN3ZGE-BIoTHd0a.js";const M=50,oe=(t,s)=>{const n=(t-1)*s,o=n+s-1;return{startIndex:n,endIndex:o}},ne=t=>t==null?void 0:t.map(s=>{const{id:n,user_id:o,f_name:i,l_name:m,phone:p,gender:h,dob:l,created_at:x,user_f_name:u,user_l_name:f,user_phone:j}=s;return{id:n,user_id:o,"Member name":`${i} ${m}`,"Member Phone":p,"parent Name":`${u} ${f}`,"parent Phone":j,gender:h,dateOfBirth:l?P(l).format("DD MMM YYYY"):"N/A",createdAt:P(x).format("DD MMM YYYY hh:mm a")}}),Fe=()=>{const{hasPermission:t}=S(),[s,n]=c.useState(null),[o,i]=c.useState(1),[m,p]=c.useState(""),h=W(m,1e3),{startIndex:l,endIndex:x}=oe(o,M),{isOpen:u,onOpen:f,onClose:j}=D(),{isOpen:_,onOpen:O,onClose:Y}=D(),{isOpen:y,onOpen:k,onClose:v}=D(),g=se(),w=R(),A=c.useRef(null),{isLoading:L,data:a,error:C}=V({queryKey:["family-members",o,h],queryFn:async()=>{const r=await Q(q.token,`get_family_member/page?start=${l}&end=${x}`);return{data:r.data,totalRecord:r.total_record}}}),T=r=>i(r);c.useEffect(()=>{A.current&&A.current.scrollIntoView({behavior:"smooth",block:"start"})},[o]),c.useEffect(()=>{C&&!g.isActive("Errortoast")&&g({id:"Errortoast",title:"Oops!",description:"Something bad happened.",status:"error",duration:2e3,isClosable:!0,position:"top"})},[C,g]);const z=ne(a==null?void 0:a.data),B=Math.ceil((a==null?void 0:a.totalRecord)/M),N=r=>n(r);return t("FAMILY_VIEW")?e.jsxs(E,{children:[L||!a?e.jsx(re,{}):e.jsxs(E,{children:[e.jsxs(d,{mb:5,justify:"space-between",align:"center",children:[e.jsx(te,{size:"md",placeholder:"Search",w:400,maxW:"50vw",onChange:r=>p(r.target.value),value:m}),e.jsx($,{size:"sm",colorScheme:"blue",onClick:f,isDisabled:!t("FAMILY_ADD"),children:"Add New"})]}),e.jsx(J,{minPad:"1px 20px",data:z,onActionClick:e.jsx(ae,{onClick:N,navigate:w,rowData:s,DeleteonOpen:O,EditonOpen:k})})]}),e.jsx(d,{justify:"center",mt:4,children:e.jsx(K,{currentPage:o,onPageChange:T,totalPages:B})}),u&&e.jsx(X,{isOpen:u,onClose:j}),_&&e.jsx(Z,{isOpen:_,onClose:Y,data:s}),y&&e.jsx(ee,{isOpen:y,onClose:v,data:s})]}):e.jsx(H,{})},re=()=>e.jsxs(E,{children:[e.jsxs(d,{mb:5,justify:"space-between",children:[e.jsx(b,{w:400,h:8}),e.jsx(b,{w:200,h:8})]}),Array.from({length:10}).map((t,s)=>e.jsx(b,{h:10,w:"100%",mt:2},s))]}),ae=({onClick:t,rowData:s,DeleteonOpen:n,EditonOpen:o})=>{const{hasPermission:i}=S();return e.jsxs(d,{justify:"center",children:[e.jsx(F,{isDisabled:!i("FAMILY_UPDATE"),size:"sm",variant:"ghost",_hover:{background:"none"},onClick:()=>{t(s),o()},icon:e.jsx(G,{fontSize:18,color:I.colors.blue[500]})}),e.jsx(F,{isDisabled:!i("FAMILY_DELETE"),size:"sm",variant:"ghost",_hover:{background:"none"},onClick:()=>{t(s),n()},icon:e.jsx(U,{fontSize:18,color:I.colors.red[500]})})]})};export{Fe as default};
