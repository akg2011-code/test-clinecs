import{r as i,Q as Y,j as e,B as g,v as M,F as B,E as A,J as F,w as R}from"./index-DLnjnVCu.js";import{e as Q}from"./index-DizZbtXV.js";import{u as $}from"./SettingData-5sbMzAiY.js";import{u as z,N as O,D as L,P as q,S as f}from"./Dashboard-BVf00d6b.js";import{A as G}from"./AddPatients-Cyv477UK.js";import{u as E}from"./HasPermission-Efb43n4z.js";import{u as V}from"./UseSearchFilter-CSdYpLEl.js";import{g as W,u as H}from"./index.esm-CU9MGMRa.js";import{F as m,I as J}from"./utils-DHjTyQ2S.js";import{I as K}from"./index-CrveBHTj.js";import"./index-DscDBtoO.js";import"./chunk-MGVPL3OH-BhiF1P3g.js";import"./image-BEsbZakN.js";import"./index-Q7d3q0Zt.js";import"./chunk-Z6RXEUPO-CjATnNZs.js";import"./IsdModal-DvHKxEmI.js";import"./chunk-FKYN3ZGE-BIoTHd0a.js";import"./useMutation-CH8xzEHB.js";import"./today-D_vLUvRX.js";import"./chunk-JARCRF6W-CtmXHheL.js";import"./chunk-3RSXBRAN-DjkGz0-1.js";const D=50,U=(t,s)=>{const r=(t-1)*s,o=r+s-1;return{startIndex:r,endIndex:o}},X=t=>t==null?void 0:t.map(s=>{const{id:r,f_name:o,l_name:u,phone:l,gender:j,dob:c,email:d,image:p,created_at:h}=s;return{id:r,name:`${o} ${u}`,phone:l,gender:j,date_Of_Birth:c?A(c).format("DD MMM YYYY"):"N/A",email:d||"N/A",image:p,created_At:A(h).format("DD MMM YYYY hh:mm a")}}),De=()=>{const{hasPermission:t}=E(),[s,r]=i.useState(null),[o,u]=i.useState(1),[l,j]=i.useState(""),c=z(l,1e3),{startIndex:d,endIndex:p}=U(o,D),{isOpen:h,onOpen:S,onClose:I}=W(),x=H(),_=Y(),P=i.useRef(null),{isLoading:y,data:a,error:b}=$({queryKey:["patients",o,c],queryFn:async()=>{const n=await F(R.token,`get_patient/page?start=${d}&end=${p}`);return{data:n.data,totalRecord:n.total_record}}}),k=n=>u(n);i.useEffect(()=>{P.current&&P.current.scrollIntoView({behavior:"smooth",block:"start"})},[o]),i.useEffect(()=>{b&&!x.isActive("Errortoast")&&x({id:"Errortoast",title:"Oops!",description:"Something bad happened.",status:"error",duration:2e3,isClosable:!0,position:"top"})},[b,x]);const w=X(a==null?void 0:a.data),C=Math.ceil((a==null?void 0:a.totalRecord)/D),T=n=>r(n),{handleSearchChange:v,filteredData:N}=V(w);return t("PATIENT_VIEW")?e.jsxs(g,{children:[y||!a?e.jsx(Z,{}):e.jsxs(g,{children:[e.jsxs(m,{mb:5,justify:"space-between",align:"center",children:[e.jsx(J,{size:"md",placeholder:"Search",w:400,maxW:"50vw",onChange:n=>v(n.target.value)}),e.jsx(M,{size:"sm",colorScheme:"blue",onClick:S,isDisabled:!t("PATIENT_ADD"),children:"Add New"})]}),e.jsx(L,{imgLast:!0,minPad:"1px 20px",data:N,onActionClick:e.jsx(ee,{onClick:T,navigate:_,rowData:s})})]}),e.jsx(m,{justify:"center",mt:4,children:e.jsx(q,{currentPage:o,onPageChange:k,totalPages:C})}),e.jsx(G,{isOpen:h,onClose:I})]}):e.jsx(O,{})},Z=()=>e.jsxs(g,{children:[e.jsxs(m,{mb:5,justify:"space-between",children:[e.jsx(f,{w:400,h:8}),e.jsx(f,{w:200,h:8})]}),Array.from({length:10}).map((t,s)=>e.jsx(f,{h:10,w:"100%",mt:2},s))]}),ee=({onClick:t,rowData:s,navigate:r})=>{const{hasPermission:o}=E();return e.jsx(m,{justify:"center",children:e.jsx(K,{isDisabled:!o("PATIENT_UPDATE"),size:"sm",variant:"ghost",_hover:{background:"none"},onClick:()=>{t(s),r(`/patient/${s.id}`)},icon:e.jsx(Q,{fontSize:18,color:B.colors.blue[500]})})})};export{De as default};
