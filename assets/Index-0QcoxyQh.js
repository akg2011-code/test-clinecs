import{t as k,j as e,v as h,av as Q,w as g,r as D,D as V,B as p,F as M,J as W}from"./index-DLnjnVCu.js";import{F as H}from"./index-DscDBtoO.js";import{e as J}from"./index-DizZbtXV.js";import{u as Y}from"./SettingData-5sbMzAiY.js";import{T as G,A as K,a as X,N as Z,S as j,D as $}from"./Dashboard-BVf00d6b.js";import{u as ee}from"./UseSearchFilter-CSdYpLEl.js";import{A as se}from"./AddMedicine-J2vEtrpC.js";import{i as te,u as S,M as ie,b as v,a as oe,c as F,h as ne,d as O,F as w,e as I,f as u,g as f}from"./index.esm-CU9MGMRa.js";import{u as re}from"./useMutation-CH8xzEHB.js";import{D as ae}from"./index-Q7d3q0Zt.js";import{b as z,I as _,F as C}from"./utils-DHjTyQ2S.js";import{u as T}from"./HasPermission-Efb43n4z.js";import{I as A}from"./index-CrveBHTj.js";import"./chunk-MGVPL3OH-BhiF1P3g.js";import"./image-BEsbZakN.js";import"./chunk-Z6RXEUPO-CjATnNZs.js";const ce=async i=>{const s=await Q(g.token,"update_prescribe_medicines",i);if(s.response!==200)throw new Error(s.message);return s};function le({isOpen:i,onClose:s,data:t}){const{register:o,handleSubmit:n}=te(),c=S(),l=k(),a=re({mutationFn:async r=>{await ce(r)},onSuccess:()=>{l.invalidateQueries("medicines"),u(c,"success","Medicine Added!"),s()},onError:r=>{u(c,"error",r.message)}}),m=r=>{a.mutate({...r,id:t.id})};return e.jsxs(ie,{isOpen:i,onClose:s,isCentered:!0,children:[e.jsx(v,{}),e.jsxs(oe,{as:"form",onSubmit:n(m),children:[e.jsx(F,{fontSize:"md",children:"Update Medicine"}),e.jsx(ne,{top:3}),e.jsx(ae,{}),e.jsxs(O,{children:[e.jsxs(z,{isRequired:!0,children:[e.jsx(w,{fontSize:"sm",children:"Name"}),e.jsx(_,{size:"md",name:"comment",...o("title",{required:!0}),defaultValue:t.title})]})," ",e.jsxs(z,{mt:3,children:[e.jsx(w,{fontSize:"sm",children:"Notes"}),e.jsx(G,{size:"md",name:"comment",...o("notes"),defaultValue:t.notes})]})," "]}),e.jsxs(I,{children:[e.jsx(h,{colorScheme:"gray",mr:3,onClick:s,size:"sm",children:"Close"}),e.jsx(h,{colorScheme:"blue",size:"sm",w:32,type:"submit",isLoading:a.isPending,children:"Update"})]})]})]})}function de({isOpen:i,onClose:s,data:t}){const o=S(),n=D.useRef(),c=k(),[l,a]=D.useState(),m=async()=>{let r={id:t.id};try{a(!0);const d=await V(g.token,"delete_prescribe_medicines",r);a(!1),d.response===200?(u(o,"success","State Deleted!"),c.invalidateQueries(["medicines"]),s()):u(o,"error",d.message)}catch(d){a(!1),u(o,"error",JSON.stringify(d))}};return e.jsx(K,{isOpen:i,onClose:s,leastDestructiveRef:n,isCentered:!0,children:e.jsx(v,{children:e.jsxs(X,{children:[e.jsxs(F,{fontSize:"lg",fontWeight:"semi-bold",children:["Delete Medicine ( ",e.jsx("b",{children:t==null?void 0:t.title})," )"]}),e.jsx(O,{children:"Are you sure? You can not undo this action afterwards."}),e.jsxs(I,{children:[e.jsx(h,{ref:n,onClick:s,colorScheme:"gray",size:"sm",children:"Cancel"}),e.jsx(h,{colorScheme:"red",onClick:m,ml:3,size:"sm",isLoading:l,children:"Delete"})]})]})})})}function Ae(){const{hasPermission:i}=T(),{isOpen:s,onOpen:t,onClose:o}=f(),[n,c]=D.useState(),{isOpen:l,onOpen:a,onClose:m}=f(),{isOpen:r,onOpen:d,onClose:N}=f(),b=S(),E="Errortoast",B=async()=>(await W(g.token,"get_prescribe_medicines")).data,L=x=>{c(x)},{isLoading:q,data:y,error:P}=Y({queryKey:["medicines"],queryFn:B}),{handleSearchChange:R,filteredData:U}=ee(y);return P&&(b.isActive(E)||b({id:E,title:"oops!.",description:"Something bad happens.",status:"error",duration:2e3,isClosable:!0,position:"top"})),i("MEDICINE_VIEW")?e.jsxs(p,{children:[q||!y?e.jsxs(p,{children:[e.jsxs(C,{mb:5,justify:"space-between",children:[e.jsx(j,{w:400,h:8}),e.jsx(j,{w:50,h:8})]}),e.jsx(j,{h:300,w:"100%"})]}):e.jsxs(p,{children:[e.jsxs(C,{mb:5,justify:"space-between",align:"center",children:[e.jsx(_,{size:"md",placeholder:"Search",w:400,maxW:"50vw",onChange:x=>R(x.target.value)}),e.jsx(p,{children:e.jsx(h,{size:"sm",colorScheme:"blue",onClick:t,isDisabled:!i("MEDICINE_ADD"),children:"Add New"})})]}),e.jsx($,{data:U,onActionClick:e.jsx(me,{onClick:L,EditonOpen:d,DeleteonOpen:a})})]}),e.jsx(se,{isOpen:s,onClose:o}),r&&e.jsx(le,{isOpen:r,onClose:N,data:n}),l&&e.jsx(de,{isOpen:l,onClose:m,data:n})]}):e.jsx(Z,{})}const me=({onClick:i,rowData:s,EditonOpen:t,DeleteonOpen:o})=>{const{hasPermission:n}=T();return e.jsxs(C,{justify:"center",children:[e.jsx(A,{isDisabled:!n("MEDICINE_UPDATE"),size:"sm",variant:"ghost",_hover:{background:"none"},onClick:()=>{i(s),t()},icon:e.jsx(J,{fontSize:18,color:M.colors.blue[500]})}),e.jsx(A,{isDisabled:!n("MEDICINE_DELETE"),size:"sm",variant:"ghost",_hover:{background:"none"},onClick:()=>{i(s),o()},icon:e.jsx(H,{fontSize:18,color:M.colors.red[500]})})]})};export{Ae as default};
