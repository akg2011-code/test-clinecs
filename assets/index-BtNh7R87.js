import{E as u,r as o,t as Q,j as t,R as v,B as d,v as F,w as m,J as A}from"./index-DLnjnVCu.js";import{u as T}from"./SettingData-5sbMzAiY.js";import{j as q,u as z,S as R,i as L,R as N,D as G,P as J}from"./Dashboard-BVf00d6b.js";import{u as K}from"./index.esm-CU9MGMRa.js";import{F as l,I as V}from"./utils-DHjTyQ2S.js";import{B as H}from"./chunk-Z6RXEUPO-CjATnNZs.js";import"./HasPermission-Efb43n4z.js";import"./index-CrveBHTj.js";import"./index-DscDBtoO.js";import"./chunk-MGVPL3OH-BhiF1P3g.js";import"./image-BEsbZakN.js";import"./index-Q7d3q0Zt.js";const O=u().subtract(q,"days").format("YYYY-MM-DD"),U=u().format("YYYY-MM-DD"),de=()=>{var y;const h=K(),p="ErrorToast",[r,b]=o.useState(1),n=o.useRef(null),[g,I]=o.useState(""),i=z(g,1e3),C=Q(),[c,Y]=o.useState({startDate:O,endDate:U}),{startDate:x,endDate:f}=c,P=(e,s)=>{const $=(e-1)*s,w=$+s-1;return{startIndex:$,endIndex:w}},{startIndex:D,endIndex:j}=P(r,50),S=async()=>{const e=m.role.name==="Doctor"?`get_doctor_review_page?start=${D}&end=${j}&start_date=${x}&end_date=${f}&search=${i}&doctor_id=${m.id}`:`get_doctor_review_page?start=${D}&end=${j}&start_date=${x}&end_date=${f}&search=${i}`,s=await A(m.token,e);return{data:s.data,totalRecord:s.total_record}},{data:a,error:_,isLoading:E,isFetching:M}=T({queryKey:["reviews",r,i,c],queryFn:S}),k=e=>{b(e)},B=Math.ceil(((a==null?void 0:a.totalRecord)||0)/50);return o.useEffect(()=>{n.current&&n.current.scrollIntoView({behavior:"smooth",block:"start"})},[r]),_?(h.isActive(p)||h({id:p,title:"Error",description:"Failed to fetch reviews.",status:"error",duration:3e3,isClosable:!0,position:"top"}),t.jsx(v,{errorCode:_.name})):t.jsx(d,{ref:n,children:E?t.jsxs(d,{children:[t.jsx(R,{height:8,width:400,mb:4}),[...Array(10)].map((e,s)=>t.jsx(R,{height:8,width:"100%",mb:2},s))]}):t.jsxs(d,{children:[t.jsxs(l,{justifyContent:"space-between",mb:4,children:[t.jsxs(l,{gap:4,children:[t.jsx(V,{placeholder:"Search reviews",value:g,onChange:e=>I(e.target.value)}),t.jsx(L,{dateRange:c,setDateRange:Y,size:"md"})]}),t.jsx(F,{isLoading:M,onClick:()=>C.invalidateQueries(["reviews"]),rightIcon:t.jsx(N,{size:16}),size:"sm",colorScheme:"blue",children:"Refresh"})]}),t.jsx(G,{minPad:3,data:(y=a==null?void 0:a.data)==null?void 0:y.map(e=>({ID:e.id,"Doctor Name":`${e.doct_f_name} ${e.doct_l_name}`,"patinent Name":`${e.f_name} ${e.l_name}`,"Appointment ID":e.appointment_id,Points:t.jsx(H,{colorScheme:e.points>=4?"green":e.points>=2?"yellow":"red",children:e.points}),Description:e.description,Date:u(e.created_at).format("DD MMM YYYY, hh:mm A")}))}),t.jsx(l,{justifyContent:"center",mt:4,children:t.jsx(J,{currentPage:r,onPageChange:k,totalPages:B})})]})})};export{de as default};
