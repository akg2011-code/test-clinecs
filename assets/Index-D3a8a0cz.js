import{r as f,t as M,j as e,v as T,D as J,w as z,B as h,T as q,N as H,O as W,P as de,M as ue,av as he,F as V,J as me}from"./index-DLnjnVCu.js";import{F as xe}from"./index-DscDBtoO.js";import{e as pe}from"./index-DizZbtXV.js";import{u as je}from"./SettingData-5sbMzAiY.js";import{u as fe}from"./UseSearchFilter-CSdYpLEl.js";import{A as ge,a as De,T as $,V as G,N as Se,S as L,D as be}from"./Dashboard-BVf00d6b.js";import{u as w,b as N,c as B,d as U,e as P,f as u,i as K,M as Y,a as X,h as Z,F as y,g as _}from"./index.esm-CU9MGMRa.js";import{a as ee,I as Q}from"./index-CrveBHTj.js";import{D as E}from"./index-Q7d3q0Zt.js";import{b as C,I as O,F}from"./utils-DHjTyQ2S.js";import{S as se}from"./chunk-3RSXBRAN-DjkGz0-1.js";import{i as ye}from"./image-BEsbZakN.js";import{u as ie}from"./HasPermission-Efb43n4z.js";import"./chunk-MGVPL3OH-BhiF1P3g.js";import"./chunk-Z6RXEUPO-CjATnNZs.js";function Ce({isOpen:p,onClose:i,data:s}){const l=w(),o=f.useRef(),g=M(),[m,a]=f.useState(),d=async()=>{let D={id:s.id};try{a(!0);const c=await J(z.token,"delete_testimonial",D);a(!1),c.response===200?(u(l,"success","Testimonial Deleted!"),g.invalidateQueries("testimonials"),i()):u(l,"error",c.message)}catch(c){a(!1),u(l,"error",JSON.stringify(c))}};return e.jsx(ge,{isOpen:p,onClose:i,leastDestructiveRef:o,isCentered:!0,children:e.jsx(N,{children:e.jsxs(De,{children:[e.jsxs(B,{fontSize:"lg",fontWeight:"semi-bold",children:["Delete Testimonial ( ",e.jsx("b",{children:s==null?void 0:s.name})," )"]}),e.jsx(U,{children:"Are you sure? You can not undo this action afterwards."}),e.jsxs(P,{children:[e.jsx(T,{ref:o,onClick:i,colorScheme:"gray",size:"sm",children:"Cancel"}),e.jsx(T,{colorScheme:"red",onClick:d,ml:3,size:"sm",isLoading:m,children:"Delete"})]})]})})})}function Te({isOpen:p,onClose:i}){const[s,l]=f.useState(),[o,g]=f.useState(null),m=f.useRef(),{register:a,handleSubmit:d,reset:D}=K(),c=M(),S=w(),v=t=>{t.preventDefault();const x=t.dataTransfer.files[0];g(x)},A=t=>{t.preventDefault()},j=t=>{const x=t.target.files[0];g(x)},R=async t=>{let x={...t,image:o};try{l(!0);const b=await de(z.token,"add_testimonial",x);l(!1),b.response===200?(u(S,"success","testimonial Added!"),c.invalidateQueries(["testimonials"]),D(),i()):u(S,"error",b.message)}catch(b){l(!1),u(S,"error",JSON.stringify(b))}};return e.jsxs(Y,{isOpen:p,onClose:i,isCentered:!0,size:"2xl",scrollBehavior:"inside",children:[e.jsx(N,{}),e.jsxs(X,{as:"form",onSubmit:d(R),children:[e.jsx(B,{fontSize:18,py:2,children:"Add Testimonial"}),e.jsx(Z,{}),e.jsx(E,{}),e.jsx(U,{children:e.jsxs(h,{pb:3,children:[e.jsxs(C,{isRequired:!0,children:[e.jsx(y,{children:"Title"}),e.jsx(O,{placeholder:"Title",...a("title",{required:!0})})]}),e.jsxs(C,{isRequired:!0,mt:5,children:[e.jsx(y,{children:"Sub Title"}),e.jsx(O,{placeholder:"Sub Title",...a("sub_title",{required:!0})})]}),e.jsxs(C,{isRequired:!0,mt:5,children:[e.jsx(y,{children:"Rating"}),e.jsx(se,{placeholder:"Rating",...a("rating",{required:!0}),children:[1,2,3,4,5].map((t,x)=>e.jsx("option",{value:t,children:t},x))})]}),e.jsxs(C,{isRequired:!0,mt:5,children:[e.jsx(y,{children:"Description"}),e.jsx($,{placeholder:"Description",...a("description",{required:!0})})]}),e.jsx(h,{mt:5,p:4,border:"2px dashed",borderColor:"gray.300",borderRadius:"md",onDrop:v,onDragOver:A,onClick:()=>{m.current&&m.current.click()},cursor:"pointer",children:o?e.jsxs(h,{position:"relative",children:[e.jsxs(q,{children:["Selected File: ",o.name]}),e.jsx(H,{position:"absolute",right:-2,top:-2,size:"sm",onClick:()=>{g(null)}})]}):e.jsxs(h,{children:[e.jsxs(G,{children:[" ",e.jsx(O,{ref:m,type:"file",onChange:j,accept:".jpeg, .svg, .png , .jpg",mb:4})]}),e.jsxs(W,{children:[" ",e.jsx(ee,{fontSize:32})]}),e.jsxs(q,{textAlign:"center",mt:3,children:[e.jsx("b",{children:"Choose a file"})," or Drag it here."]})]})})]})}),e.jsx(E,{}),e.jsxs(P,{py:3,children:[e.jsx(T,{colorScheme:"gray",mr:3,onClick:i,size:"sm",children:"Close"}),e.jsx(T,{variant:"solid",size:"sm",colorScheme:"blue",type:"submit",isLoading:s,children:"Add"})]})]})]})}function ve({isOpen:p,onClose:i,data:s}){const[l,o]=f.useState(),[g,m]=f.useState(),[a,d]=f.useState(null),D=f.useRef(),{register:c,handleSubmit:S,reset:v}=K(),A=M(),j=w(),R=n=>{n.preventDefault();const r=n.dataTransfer.files[0];d(r)},t=n=>{n.preventDefault()},x=n=>{const r=n.target.files[0];d(r)},b=async n=>{let r={...n,image:a,id:s.id};try{o(!0);const k=await he(z.token,"update_testimonial",r);o(!1),k.response===200?(u(j,"success","Testimonial Updated!"),A.invalidateQueries("testimonials"),v(),d(null),i()):u(j,"error",k.message)}catch(k){o(!1),u(j,"error",JSON.stringify(k))}},I=async()=>{let n={id:s.id};try{m(!0);const r=await J(z.token,"remove_testimonia_image",n);m(!1),r.response===200?(u(j,"success","Image deleted!"),A.invalidateQueries("testimonials"),v(),d(null),i()):u(j,"error",r.message)}catch(r){m(!1),u(j,"error",JSON.stringify(r))}};return e.jsxs(Y,{isOpen:p,onClose:i,isCentered:!0,size:"lg",scrollBehavior:"inside",children:[e.jsx(N,{}),e.jsxs(X,{as:"form",onSubmit:S(b),children:[e.jsx(B,{fontSize:18,py:2,children:"Update Testimonials"}),e.jsx(Z,{}),e.jsx(E,{}),e.jsx(U,{children:e.jsxs(h,{pb:3,children:[e.jsxs(C,{isRequired:!0,children:[e.jsx(y,{children:"Title"}),e.jsx(O,{placeholder:"Title",defaultValue:s==null?void 0:s.name,...c("title",{required:!0})})]}),e.jsxs(C,{isRequired:!0,mt:5,children:[e.jsx(y,{children:"Sub Title"}),e.jsx(O,{placeholder:"Sub Title",defaultValue:s==null?void 0:s.sub_title,...c("sub_title",{required:!0})})]}),e.jsxs(C,{isRequired:!0,mt:5,children:[e.jsx(y,{children:"Rating"}),e.jsx(se,{placeholder:"Rating",...c("rating",{required:!0}),defaultValue:s==null?void 0:s.rating,children:[1,2,3,4,5].map((n,r)=>e.jsx("option",{value:n,children:n},r))})]}),e.jsxs(C,{isRequired:!0,mt:5,children:[e.jsx(y,{children:"Description"}),e.jsx($,{placeholder:"Description",defaultValue:s==null?void 0:s.description,...c("description",{required:!0})})]}),(s==null?void 0:s.image)&&e.jsxs(F,{mt:5,align:"center",gap:5,children:[e.jsx(ue,{src:`${ye}/${s==null?void 0:s.image}`,width:100,borderRadius:5}),e.jsx(T,{size:"sm",colorScheme:"red",fontSize:12,isLoading:g,onClick:I,children:"Remove Image"})]}),!(s!=null&&s.image)&&e.jsx(h,{mt:5,p:4,border:"2px dashed",borderColor:"gray.300",borderRadius:"md",onDrop:R,onDragOver:t,onClick:()=>{D.current&&D.current.click()},cursor:"pointer",children:a?e.jsxs(h,{position:"relative",children:[e.jsxs(q,{children:["Selected File: ",a.name]}),e.jsx(H,{position:"absolute",right:-2,top:-2,size:"sm",onClick:()=>{d(null)}})]}):e.jsxs(h,{children:[e.jsxs(G,{children:[" ",e.jsx(O,{ref:D,type:"file",onChange:x,accept:".jpeg, .svg, .png , .jpg",mb:4})]}),e.jsxs(W,{children:[" ",e.jsx(ee,{fontSize:32})]}),e.jsxs(q,{textAlign:"center",mt:3,children:[e.jsx("b",{children:"Choose a file"})," or Drag it here."]})]})})]})}),e.jsx(E,{}),e.jsxs(P,{py:3,children:[e.jsx(T,{colorScheme:"gray",mr:3,onClick:i,size:"sm",children:"Close"}),e.jsx(T,{variant:"solid",size:"sm",colorScheme:"blue",type:"submit",isLoading:l,children:"Update"})]})]})]})}function Pe(){const{isOpen:p,onOpen:i,onClose:s}=_(),[l,o]=f.useState(),{isOpen:g,onOpen:m,onClose:a}=_(),{isOpen:d,onOpen:D,onClose:c}=_(),S=w(),v="Errortoast",A=async()=>(await me(z.token,"get_testimonial")).data.map(re=>{const{id:te,title:ne,sub_title:oe,description:le,rating:ae,image:ce}=re;return{id:te,name:ne,sub_title:oe,rating:ae,image:ce,description:le}}),j=r=>{o(r)},{isLoading:R,data:t,error:x}=je({queryKey:["testimonials"],queryFn:A}),{handleSearchChange:b,filteredData:I}=fe(t);x&&(S.isActive(v)||S({id:v,title:"Oops!",description:"Something bad happened.",status:"error",duration:2e3,isClosable:!0,position:"top"}));const{hasPermission:n}=ie();return n("TESTIMONIAL_VIEW")?e.jsxs(h,{children:[R||!t?e.jsxs(h,{children:[e.jsxs(F,{mb:5,justify:"space-between",children:[e.jsx(L,{w:400,h:8}),e.jsx(L,{w:50,h:8})]}),e.jsx(L,{h:300,w:"100%"})]}):e.jsxs(h,{children:[e.jsxs(F,{mb:5,justify:"space-between",align:"center",children:[e.jsx(O,{size:"md",placeholder:"Search",w:400,maxW:"50vw",onChange:r=>b(r.target.value)}),e.jsx(h,{children:e.jsx(T,{size:"sm",colorScheme:"blue",onClick:i,isDisabled:!n("TESTIMONIAL_ADD"),children:"Add New"})})]}),e.jsx(be,{minPad:"8px 8px",data:I,onActionClick:e.jsx(Oe,{onClick:j,DeleteonOpen:m,EditonOpen:D})})]}),e.jsx(Te,{isOpen:p,onClose:s}),e.jsx(Ce,{isOpen:g,onClose:a,data:l}),d&&e.jsx(ve,{isOpen:d,onClose:c,data:l})]}):e.jsx(Se,{})}const Oe=({onClick:p,rowData:i,DeleteonOpen:s,EditonOpen:l})=>{const{hasPermission:o}=ie();return e.jsxs(F,{justify:"center",children:[e.jsx(Q,{size:"sm",variant:"ghost",_hover:{background:"none"},onClick:()=>{p(i),l()},icon:e.jsx(pe,{fontSize:18,color:V.colors.blue[500]}),isDisabled:!o("TESTIMONIAL_UPDATE")}),e.jsx(Q,{size:"sm",variant:"ghost",_hover:{background:"none"},onClick:()=>{p(i),s()},icon:e.jsx(xe,{fontSize:18,color:V.colors.red[500]}),isDisabled:!o("TESTIMONIAL_DELETE")})]})};export{Pe as default};
